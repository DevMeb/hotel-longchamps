import{A,r as o,B as F,b,k as w,C as c}from"./app-MOnSz09z.js";import{n as d}from"./utils-mT5RtY73.js";const $=A("renters",()=>{const s=o([]),n=o({}),f=o({}),i=F("renter-filters",{last_name:"",first_name:"",tutor:""});function R(e){i.value=e}const S=b(()=>Object.values(i.value).some(e=>e!=="")),v=o([]);w([s,i],()=>{v.value=s.value.filter(e=>{const{last_name:t,first_name:a,tutor:r}=i.value;return!(t&&e.last_name!==t||a&&e.first_name!==a||r&&(!e.tutor||e.tutor.id!==parseInt(r)))})},{deep:!0,immediate:!0});function m(e){e?n.value[e]=null:n.value={}}function p(e,t){f.value[e]=t}async function l({operation:e,request:t,onSuccess:a}){var r,y,g;m(e),p(e,!0);try{const u=await t();return a&&a(u),u}catch(u){((r=u.response)==null?void 0:r.status)===422?n.value.validationErrors=u.response.data.errors:(n.value[e]=((g=(y=u.response)==null?void 0:y.data)==null?void 0:g.message)||"Une erreur est survenue.",d("error",n.value[e]))}finally{p(e,!1)}}async function _(){return l({operation:"fetch",request:()=>c.get("/api/renters"),onSuccess:e=>{s.value=e.data.data}})}async function h(e){return l({operation:"add",request:()=>c.post("/api/renters",e),onSuccess:t=>{s.value.push(t.data.data),d("success",t.data.message)}})}async function q(e){return l({operation:"update",request:()=>c.put(`/api/renters/${e.id}`,e),onSuccess:t=>{const a=s.value.findIndex(r=>r.id===e.id);a!==-1&&(s.value[a]=t.data.data),d("success",t.data.message)}})}async function x(e){return l({operation:"delete",request:()=>c.delete(`/api/renters/${e}`),onSuccess:t=>{s.value=s.value.filter(a=>a.id!==e),d("success",t.data.message)}})}return{renters:s,errors:n,loading:f,fetchRenters:_,addRenter:h,updateRenter:q,deleteRenter:x,clearErrors:m,activeFilters:i,updateFilters:R,filteredRenters:v,isAnyFilterActive:S}});export{$ as u};
