import{s as H,b as J,r as K,z as P,o as d,c as u,a as e,w as A,t as o,f as m,i as _,v as g,n as f,u as i,e as c}from"./app-MOnSz09z.js";import{a as Q}from"./InvoiceSendMailModal.vue_vue_type_style_index_0_scoped_b9107dd6_lang-CoR13ITW.js";import{b as B}from"./utils-mT5RtY73.js";const W={class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-md"},X={class:"bg-white p-6 rounded-xl shadow-xl w-[90%] sm:w-[70%] transform transition-all animate-fade-in"},Y={class:"flex items-center justify-between border-b pb-2"},Z={class:"text-xl font-semibold text-gray-800 flex items-center"},$={class:"bg-gray-100 p-3 rounded-lg space-y-2"},ee={class:"text-sm text-gray-700"},te={class:"text-sm text-gray-700"},se={class:"text-sm text-gray-700"},ie={key:0,class:"error-message"},ae={key:0},ne={key:0,class:"error-message"},oe={key:0,class:"error-message"},re={key:0,class:"error-message"},le={class:"flex justify-end space-x-3 mt-4"},de=["disabled"],ue={key:0,class:"animate-spin mr-2"},pe={__name:"InvoiceFormModal",props:{invoice:Object,reservation:Object},emits:["close"],setup(F,{emit:O}){const x=Q(),{addInvoice:R,updateInvoice:z,clearErrors:L}=x,{errors:a,loading:v}=H(x),n=F,b=J(()=>{var r;return n.reservation||((r=n.invoice)==null?void 0:r.reservation)||null}),q=O,s=K({id:null,reservation_id:null,subject:"",description:"",billing_start_date:"",billing_end_date:"",status:"pending"});P(()=>{var r,t;s.value=n.invoice?{id:n.invoice.id,reservation_id:((r=n.invoice.reservation)==null?void 0:r.id)||null,subject:n.invoice.subject||"",description:n.invoice.description||"",billing_start_date:B(n.invoice.billing_start_date)||"",billing_end_date:B(n.invoice.billing_end_date)||"",status:"pending"}:{id:null,reservation_id:((t=n.reservation)==null?void 0:t.id)||null,subject:"",description:"",billing_start_date:"",billing_end_date:"",status:"pending"}});const G=async()=>{(s.value.id?await z(s.value):await R(s.value))&&p()},p=()=>{L("validationErrors"),q("close")};return(r,t)=>{var y,j,k,E,w,C,V,D,S,I,M,N,U,h,T;return d(),u("div",W,[e("div",{onClick:A(p,["self"]),class:"fixed inset-0"}),e("div",X,[e("div",Y,[e("h2",Z,o(s.value.id?"‚úèÔ∏è √âditer une facture":"üßæ Ajouter une facture"),1),e("button",{onClick:p,class:"text-gray-500 hover:text-gray-700 transition"},"‚úñÔ∏è")]),e("form",{onSubmit:A(G,["prevent"]),class:"mt-4 space-y-4"},[e("div",$,[e("p",ee,[t[4]||(t[4]=e("strong",null,"R√©servation #:",-1)),m(" "+o(((y=b.value)==null?void 0:y.id)||"Non assign√©e"),1)]),e("p",te,[t[5]||(t[5]=e("strong",null,"Locataire:",-1)),m(" "+o((k=(j=b.value)==null?void 0:j.renter)==null?void 0:k.last_name.toUpperCase())+" "+o((w=(E=b.value)==null?void 0:E.renter)==null?void 0:w.first_name),1)]),e("p",se,[t[6]||(t[6]=e("strong",null,"Chambre:",-1)),m(" "+o(((V=(C=b.value)==null?void 0:C.room)==null?void 0:V.name)||"Non assign√©e"),1)])]),e("div",null,[t[7]||(t[7]=e("label",{for:"subject",class:"block text-sm font-medium text-gray-700"},"Sujet",-1)),_(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=l=>s.value.subject=l),class:f(["input-field",{"border-red-500":(D=i(a).validationErrors)==null?void 0:D.subject}]),placeholder:"Ex: Loyer janvier 2024"},null,2),[[g,s.value.subject]]),(S=i(a).validationErrors)!=null&&S.subject?(d(),u("p",ie,o(i(a).validationErrors.subject.join(" ")),1)):c("",!0)]),s.value.id?(d(),u("div",ae,[t[8]||(t[8]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),_(e("textarea",{rows:"4","onUpdate:modelValue":t[1]||(t[1]=l=>s.value.description=l),class:f(["input-field",{"border-red-500":(I=i(a).validationErrors)==null?void 0:I.description}])},null,2),[[g,s.value.description]]),(M=i(a).validationErrors)!=null&&M.description?(d(),u("p",ne,o(i(a).validationErrors.description.join(" ")),1)):c("",!0)])):c("",!0),e("div",null,[t[9]||(t[9]=e("label",{for:"billing_start_date",class:"block text-sm font-medium text-gray-700"},"D√©but de facturation",-1)),_(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=l=>s.value.billing_start_date=l),class:f(["input-field",{"border-red-500":(N=i(a).validationErrors)==null?void 0:N.billing_start_date}])},null,2),[[g,s.value.billing_start_date]]),(U=i(a).validationErrors)!=null&&U.billing_start_date?(d(),u("p",oe,o(i(a).validationErrors.billing_start_date.join(" ")),1)):c("",!0)]),e("div",null,[t[10]||(t[10]=e("label",{for:"billing_end_date",class:"block text-sm font-medium text-gray-700"},"Fin de facturation",-1)),_(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=l=>s.value.billing_end_date=l),class:f(["input-field",{"border-red-500":(h=i(a).validationErrors)==null?void 0:h.billing_end_date}])},null,2),[[g,s.value.billing_end_date]]),(T=i(a).validationErrors)!=null&&T.billing_end_date?(d(),u("p",re,o(i(a).validationErrors.billing_end_date.join(" ")),1)):c("",!0)]),e("div",le,[e("button",{type:"button",onClick:p,class:"btn-secondary"},"Annuler"),e("button",{type:"submit",class:"btn-primary flex items-center",disabled:s.value.id?i(v).update:i(v).add},[(s.value.id?i(v).update:i(v).add)?(d(),u("span",ue,"‚è≥")):c("",!0),m(" "+o(s.value.id?"Mettre √† jour":"Ajouter"),1)],8,de)])],32)])])}}};export{pe as _};
