import{s as j,r as u,l as A,o as l,c as i,a as e,t as I,u as g,e as _,w as E,f as M,i as S,v as C}from"./app-MOnSz09z.js";import{a as $}from"./InvoiceSendMailModal.vue_vue_type_style_index_0_scoped_b9107dd6_lang-CoR13ITW.js";import{v as D}from"./utils-mT5RtY73.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center"},V={class:"bg-white p-6 rounded-lg shadow-lg w-4/5 h-4/5 relative"},B={class:"text-xl font-semibold text-gray-800 mb-4"},N=["src"],T={key:1,class:"flex flex-col items-center justify-center h-full"},O={key:0,class:"flex flex-col items-center space-y-2"},U={key:1,class:"text-red-500 text-center"},Y={__name:"InvoicePdfModal",props:{invoice:Object},emits:["close"],setup(c,{emit:v}){const d=c,p=v,n=$(),{getInvoicePdf:f}=n,{loading:m}=j(n),o=u(""),t=u(null);return A(async()=>{try{t.value=null,o.value=null,o.value=await f(d.invoice.id)}catch{t.value="Impossible de charger le PDF."}}),(x,s)=>(l(),i("div",P,[e("div",V,[e("button",{onClick:s[0]||(s[0]=b=>p("close")),class:"absolute top-3 right-3 text-gray-600 hover:text-gray-800"}," ‚úñ "),e("h2",B,"üßæ Facture #"+I(c.invoice.id),1),o.value?(l(),i("iframe",{key:0,src:o.value,class:"w-full h-full"},null,8,N)):(l(),i("div",T,[g(m).pdf?(l(),i("div",O,s[1]||(s[1]=[e("span",{class:"animate-spin border-4 border-gray-400 border-t-transparent rounded-full w-10 h-10"},null,-1),e("p",{class:"text-gray-500"},"Chargement du PDF...",-1)]))):t.value?(l(),i("div",U,s[2]||(s[2]=[e("p",null,"‚ùå Erreur lors du chargement du PDF.",-1)]))):_("",!0)]))])]))}},R={class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-md"},q={class:"bg-white p-6 rounded-xl shadow-xl w-[90%] sm:w-96 transform transition-all animate-fade-in"},z={key:0,class:"error-message"},G={class:"flex justify-end space-x-3 mt-4"},H=["disabled"],J={key:0,class:"animate-spin mr-2"},K={__name:"InvoiceSendMailModal",props:{invoice:Object},emits:["close"],setup(c,{emit:v}){var b,h,k,w;const d=c,p=v,n=$(),{sendEmail:f}=n,{loading:m}=j(n),o=u((w=(k=(h=(b=d.invoice)==null?void 0:b.reservation)==null?void 0:h.renter)==null?void 0:k.tutor)==null?void 0:w.email),t=u({}),x=async()=>{t.value={};let y=o.value.split(";").map(r=>r.trim());if(y.filter(r=>!D(r)).length>0){t.value.emailAddress="Adresse(s) email invalide(s)";return}await f(d.invoice.id,y.join(";")),s()},s=()=>{t.value={},p("close")};return(y,a)=>(l(),i("div",R,[e("div",{onClick:E(s,["self"]),class:"fixed inset-0"}),e("div",q,[e("div",{class:"flex items-center justify-between border-b pb-2"},[a[1]||(a[1]=e("h2",{class:"text-xl font-semibold text-gray-800 flex items-center"}," üì© Envoyer la facture par email ",-1)),e("button",{onClick:s,class:"text-gray-500 hover:text-gray-700 transition"},"‚úñÔ∏è")]),e("form",{onSubmit:E(x,["prevent"]),class:"mt-4 space-y-4"},[e("div",null,[a[2]||(a[2]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700"},[M(" Adresse(s) email(s) "),e("span",{class:"text-gray-500"},'(s√©par√©es par ";")')],-1)),S(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=r=>o.value=r),class:"input-field",placeholder:"ex: user1@example.com; user2@example.com"},null,512),[[C,o.value]]),t.value.emailAddress?(l(),i("p",z,I(t.value.emailAddress),1)):_("",!0)]),e("div",G,[e("button",{type:"button",onClick:s,class:"btn-secondary"},"Annuler"),e("button",{type:"submit",class:"btn-primary flex items-center",disabled:g(m).sendEmail},[g(m).sendEmail?(l(),i("span",J,"‚è≥")):_("",!0),a[3]||(a[3]=M(" Envoyer "))],8,H)])],32)])]))}},Z=F(K,[["__scopeId","data-v-b9107dd6"]]);export{Z as I,Y as _};
