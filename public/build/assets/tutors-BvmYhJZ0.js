import{A as x,r as l,B as C,b as A,k as F,C as c}from"./app-MOnSz09z.js";import{n as d}from"./utils-mT5RtY73.js";const E=x("tutors",()=>{const s=l([]),u=l({}),f=l({}),i=C("tutor-filters",{last_name:"",first_name:"",email:""});function S(e){i.value=e}const T=A(()=>Object.values(i.value).some(e=>e!=="")),v=l([]);F([s,i],()=>{v.value=s.value.filter(e=>{const{last_name:t,first_name:a,email:r}=i.value;return!(t&&e.last_name!==t||a&&e.first_name!==a||r&&!e.email.toLowerCase().includes(r.toLowerCase()))})},{deep:!0,immediate:!0});function m(e){e?u.value[e]=null:u.value={}}function p(e,t){f.value[e]=t}async function o({operation:e,request:t,onSuccess:a}){var r,y,g;m(e),p(e,!0);try{const n=await t();return a&&a(n),n}catch(n){((r=n.response)==null?void 0:r.status)===422?u.value.validationErrors=n.response.data.errors:(u.value[e]=((g=(y=n.response)==null?void 0:y.data)==null?void 0:g.message)||"Une erreur est survenue.",d("error",u.value[e]))}finally{p(e,!1)}}async function _(){return o({operation:"fetch",request:()=>c.get("/api/tutors"),onSuccess:e=>{s.value=e.data.data}})}async function h(e){return o({operation:"add",request:()=>c.post("/api/tutors",e),onSuccess:t=>{s.value.push(t.data.data),d("success",t.data.message)}})}async function q(e){return o({operation:"update",request:()=>c.put(`/api/tutors/${e.id}`,e),onSuccess:t=>{const a=s.value.findIndex(r=>r.id===e.id);a!==-1&&(s.value[a]=t.data.data),d("success",t.data.message)}})}async function w(e){return o({operation:"delete",request:()=>c.delete(`/api/tutors/${e}`),onSuccess:t=>{s.value=s.value.filter(a=>a.id!==e),d("success",t.data.message)}})}return{tutors:s,errors:u,loading:f,fetchTutors:_,addTutor:h,updateTutor:q,deleteTutor:w,clearErrors:m,activeFilters:i,updateFilters:S,filteredTutors:v,isAnyFilterActive:T}});export{E as u};
