import{s as D,o,c as a,a as t,t as n,u as r,r as k,b as I,n as R,F as h,d as S,w as P,e as f,f as N,g as E,h as x,i as O,v as z,j as U}from"./app-MOnSz09z.js";import{f as C,a as w,_ as q}from"./utils-mT5RtY73.js";import{u as M,a as G}from"./InvoiceSendMailModal.vue_vue_type_style_index_0_scoped_b9107dd6_lang-CoR13ITW.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./renters-BWrsbS6i.js";import"./rooms-BBmIhNCl.js";import{_ as H,I as J}from"./InvoiceSendMailModal-CmaRKEuw.js";import"./hotel-logo-EkMEN4AC.js";const K={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 text-white mb-8 mt-8"},Q={class:"dashboard-card bg-blue-500"},W={class:"info"},X={class:"value"},Y={class:"dashboard-card bg-green-500"},Z={class:"info"},tt={class:"value"},st={class:"dashboard-card bg-yellow-500"},et={class:"info"},ot={class:"value"},nt={class:"dashboard-card bg-red-500"},at={class:"info"},it={class:"value"},rt={__name:"DashboardSummary",setup(i){const v=M(),{totalReservations:e,totalFactured:_,totalDifference:l,totalExpected:m}=D(v);return(g,s)=>(o(),a("div",K,[t("div",Q,[s[1]||(s[1]=t("div",{class:"icon-container"}," 📌 ",-1)),t("div",W,[s[0]||(s[0]=t("p",{class:"title"},"Total Réservations",-1)),t("p",X,n(r(e)),1)])]),t("div",Y,[s[3]||(s[3]=t("div",{class:"icon-container"}," 💰 ",-1)),t("div",Z,[s[2]||(s[2]=t("p",{class:"title"},"Montant Facturé",-1)),t("p",tt,n(r(_))+" €",1)])]),t("div",st,[s[5]||(s[5]=t("div",{class:"icon-container"}," 📅 ",-1)),t("div",et,[s[4]||(s[4]=t("p",{class:"title"},"Montant Attendu",-1)),t("p",ot,n(r(m))+" €",1)])]),t("div",nt,[s[7]||(s[7]=t("div",{class:"icon-container"}," ⚖️ ",-1)),t("div",at,[s[6]||(s[6]=t("p",{class:"title"},"Différence Totale",-1)),t("p",it,n(r(l))+" €",1)])])]))}},lt=F(rt,[["__scopeId","data-v-baa1c744"]]),dt={key:0,class:"invoice-container"},ct={key:0,class:"invoice-list"},ut={class:"invoice-status"},vt={class:"status-label"},_t={class:"invoice-items"},mt={class:"invoice-details"},pt={class:"invoice-subject"},gt={class:"text-gray-300"},bt={class:"invoice-dates"},ft={class:"invoice-actions"},ht={class:"invoice-amount"},xt=["onClick"],$t=["onClick"],yt=["onClick","disabled"],kt={key:0,class:"animate-spin border-4 border-white border-t-transparent rounded-full w-4 h-4 mr-2"},wt={key:1,class:"no-invoices"},It={__name:"InvoiceList",props:{invoices:Object},setup(i){const v=G(),{invoicePaid:e}=v,_=i,l=k(!1),m=k(null),g=k(null),s=k({}),$=()=>{l.value=!l.value},y=c=>{m.value=c},j=c=>{g.value=c};async function B(c){s.value[c.id]||(s.value={...s.value,[c.id]:!0},await e(c),s.value={...s.value,[c.id]:!1})}const V=I(()=>Object.keys(_.invoices||{}).length>0),A=I(()=>{if(!_.invoices)return{};const c={paid:1,issued:2,pending:3},u=Object.keys(_.invoices).sort((p,d)=>(c[p]||99)-(c[d]||99)),b={};return u.forEach(p=>{b[p]=_.invoices[p]}),b}),L=c=>({pending:"🟡 En attente",issued:"🟢 Émise",paid:"🔵 Payée"})[c]||"⚪ Inconnu";return(c,u)=>(o(),a(h,null,[V.value?(o(),a("div",dt,[t("button",{onClick:$,class:"toggle-button"},[u[2]||(u[2]=t("span",{class:"text-lg"},"📜 Factures",-1)),t("span",{class:R([{"rotate-180":l.value},"transition-transform"])},"🔽",2)]),l.value?(o(),a("div",ct,[(o(!0),a(h,null,S(A.value,(b,p)=>(o(),a("div",{key:p,class:"invoice-group"},[t("h4",ut,[t("span",vt,n(L(p)),1)]),t("ul",_t,[(o(!0),a(h,null,S(b,d=>(o(),a("li",{key:d.id,class:"invoice-item"},[t("div",mt,[t("div",pt,[u[3]||(u[3]=t("span",{class:"text-gray-400"},"📝",-1)),t("span",gt," #"+n(d.id)+" - "+n(d.subject||`Facture #${d.id}`),1)]),t("div",bt," 📅 "+n(r(C)(d.billing_start_date))+" → "+n(r(C)(d.billing_end_date)||"En cours"),1)]),t("div",ft,[t("span",ht,n(r(w)(d.amount)),1),t("button",{onClick:P(T=>y(d),["stop"]),class:"pdf-button"}," 📄 PDF ",8,xt),p==="pending"?(o(),a("button",{key:0,onClick:P(T=>j(d),["stop"]),class:"email-button"}," 📧 Email ",8,$t)):f("",!0),d.status==="issued"?(o(),a("button",{key:1,onClick:T=>B(d),disabled:s.value[d.id],class:"btn-action bg-green-500 disabled:opacity-50 flex items-center"},[s.value[d.id]?(o(),a("span",kt)):f("",!0),u[4]||(u[4]=N(" ✅ Payé "))],8,yt)):f("",!0)])]))),128))])]))),128))])):f("",!0)])):(o(),a("div",wt," 🚫 Aucune facture générée ")),m.value?(o(),E(r(H),{key:2,invoice:m.value,onClose:u[0]||(u[0]=b=>m.value=null)},null,8,["invoice"])):f("",!0),g.value?(o(),E(r(J),{key:3,invoice:g.value,onClose:u[1]||(u[1]=b=>g.value=null)},null,8,["invoice"])):f("",!0)],64))}},Ct=F(It,[["__scopeId","data-v-277d43ee"]]),St={__name:"StatusBadge",props:{status:String},setup(i){const v=i,e=I(()=>({ongoing:"bg-yellow-500 text-white",completed:"bg-gray-500 text-white",pending:"bg-yellow-500 text-white",issued:"bg-green-500 text-white",paid:"bg-blue-500 text-white"})[v.status]||"bg-gray-300 text-gray-800"),_=I(()=>({ongoing:"En cours",completed:"Terminée",pending:"En attente",issued:"Émise",paid:"Payée"})[v.status]||"Inconnu");return(l,m)=>(o(),a("span",{class:R(["px-3 py-1 rounded-full text-xs font-semibold",e.value])},n(_.value),3))}},Et={class:"reservation-card"},Dt={class:"header"},Mt={class:"reservation-id"},Ft={class:"section"},Tt={class:"section-content"},Pt={class:"text-lg font-semibold text-indigo-400"},Rt={class:"text-white"},jt={class:"section"},Bt={class:"section-content"},Vt={class:"text-white"},At={class:"section"},Lt={class:"finance-grid"},Nt={class:"finance-box"},Ot={class:"value text-yellow-400"},zt={class:"finance-box"},Ut={class:"value text-green-400"},qt={class:"finance-box"},Gt={class:"value text-red-400"},Ht={__name:"ReservationItem",props:{reservation:Object},setup(i){return(v,e)=>(o(),a("div",Et,[t("div",Dt,[t("h2",Mt,"🛎️ Réservation #"+n(i.reservation.id),1),x(St,{status:i.reservation.end_date?"completed":"ongoing"},null,8,["status"])]),t("div",Ft,[e[0]||(e[0]=t("div",{class:"section-title"},"🏠 Chambre & Locataire",-1)),t("div",Tt,[t("p",Pt,n(i.reservation.room.name),1),t("p",Rt,n(i.reservation.renter.first_name)+" "+n(i.reservation.renter.last_name),1)])]),t("div",jt,[e[1]||(e[1]=t("div",{class:"section-title"},"📅 Période de Réservation",-1)),t("div",Bt,[t("p",Vt,n(r(C)(i.reservation.start_date))+" → "+n(i.reservation.end_date?r(C)(i.reservation.end_date):"En cours"),1)])]),t("div",At,[e[5]||(e[5]=t("div",{class:"section-title"},"💰 Informations Financières",-1)),t("div",Lt,[t("div",Nt,[e[2]||(e[2]=t("p",{class:"label"},"💰 Montant prévu",-1)),t("p",Ot,n(r(w)(i.reservation.expected_amount)),1)]),t("div",zt,[e[3]||(e[3]=t("p",{class:"label"},"💵 Montant facturé",-1)),t("p",Ut,n(r(w)(i.reservation.actual_amount)),1)]),t("div",qt,[e[4]||(e[4]=t("p",{class:"label"},"⚖️ Différence",-1)),t("p",Gt,n(r(w)(i.reservation.difference)),1)])])]),x(Ct,{invoices:i.reservation.invoices},null,8,["invoices"])]))}},Jt=F(Ht,[["__scopeId","data-v-ba187d4b"]]),Kt={class:"flex items-center space-x-3 bg-gray-800 p-3 rounded-lg shadow-md"},Qt={__name:"MonthSelector",setup(i){const v=M(),{selectedMonth:e}=D(v);return(_,l)=>(o(),a("div",Kt,[l[1]||(l[1]=t("label",{for:"month-selector",class:"text-white text-sm font-semibold"}," 📅 Sélectionnez une période : ",-1)),O(t("input",{type:"month",id:"month-selector","onUpdate:modelValue":l[0]||(l[0]=m=>U(e)?e.value=m:null),class:"bg-gray-700 text-white rounded-md px-4 py-2 border border-gray-600 focus:ring-2 focus:ring-indigo-500"},null,512),[[z,r(e),void 0,{trim:!0}]])]))}},Wt={class:"bg-gray-900 min-h-screen p-6"},Xt={key:0,class:"text-center text-white text-lg"},Yt={key:1,class:"text-center text-red-400"},Zt={key:2,class:"grid grid-cols-1 gap-6"},ls={__name:"Dashboard",setup(i){const v=M(),{dashboardData:e,loading:_,error:l,selectedMonth:m}=D(v);return(g,s)=>{var $;return o(),a(h,null,[x(q),t("div",Wt,[s[0]||(s[0]=t("h1",{class:"text-3xl font-bold text-white mb-6"},"Tableau de Bord",-1)),x(Qt),x(lt),r(_)?(o(),a("div",Xt,"Chargement...")):r(l)?(o(),a("div",Yt,n(r(l)),1)):(o(),a("div",Zt,[(o(!0),a(h,null,S(($=r(e))==null?void 0:$.reservations,y=>(o(),E(Jt,{key:y.id,reservation:y},null,8,["reservation"]))),128))]))])],64)}}};export{ls as default};
