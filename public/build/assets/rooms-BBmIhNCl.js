import{A as F,r as c,B as b,b as w,k as C,C as l}from"./app-MOnSz09z.js";import{n as d}from"./utils-mT5RtY73.js";const j=F("rooms",()=>{const t=c([]),n=c({}),f=c({}),u=b("room-filters",{name:"",rent:""});function R(e){u.value=e}const S=w(()=>Object.values(u.value).some(e=>e!=="")),m=c([]);C([t,u],()=>{m.value=t.value.filter(e=>{const{name:s,rent:a}=u.value;return!(s&&e.name!==s||a&&e.rent!==a)})},{deep:!0,immediate:!0});function v(e){e?n.value[e]=null:n.value={}}function p(e,s){f.value[e]=s}async function o({operation:e,request:s,onSuccess:a}){var i,y,g;v(e),p(e,!0);try{const r=await s();return a&&a(r),r}catch(r){console.error(r),((i=r.response)==null?void 0:i.status)===422?n.value.validationErrors=r.response.data.errors:(n.value[e]=((g=(y=r.response)==null?void 0:y.data)==null?void 0:g.message)||"Une erreur est survenue.",d("error",n.value[e]))}finally{p(e,!1)}}async function h(){return o({operation:"fetch",request:()=>l.get("/api/rooms"),onSuccess:e=>{t.value=e.data.data}})}async function q(e){return o({operation:"add",request:()=>l.post("/api/rooms",e),onSuccess:s=>{t.value.push(s.data.data),d("success",s.data.message)}})}async function x(e){return o({operation:"update",request:()=>l.put(`/api/rooms/${e.id}`,e),onSuccess:s=>{const a=t.value.findIndex(i=>i.id===e.id);a!==-1&&(t.value[a]=s.data.data),d("success",s.data.message)}})}async function A(e){return o({operation:"delete",request:()=>l.delete(`/api/rooms/${e}`),onSuccess:s=>{t.value=t.value.filter(a=>a.id!==e),d("success",s.data.message)}})}return{rooms:t,errors:n,loading:f,fetchRooms:h,addRoom:q,updateRoom:x,deleteRoom:A,clearErrors:v,activeFilters:u,updateFilters:R,filteredRooms:m,isAnyFilterActive:S}});export{j as u};
